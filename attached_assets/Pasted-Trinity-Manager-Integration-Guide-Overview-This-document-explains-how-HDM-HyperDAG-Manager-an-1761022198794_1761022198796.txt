Trinity Manager Integration Guide
ðŸŽ¯ Overview
This document explains how HDM (HyperDAG Manager) and Mel (ImageBearerAI) can connect to APM (AI Prompt Manager) to form the complete Trinity system.

âœ… Current Status
APM is ONLINE!

Auto-registered on server startup
Shows as "1 of 1 Trinity managers online"
Ready to receive HDM and Mel connections
ðŸ”Œ How to Connect External Managers
Step 1: Obtain API Key
Each Trinity manager needs a valid API key. Valid keys are:

HYPERDAG_API_KEY - For HDM
IMAGEBEARERAI_API_KEY_PRIMARY - For Mel/ImageBearerAI
PURPOSEHUB_API_KEY_PRIMARY - For PurposeHub systems
These are configured as environment secrets in APM.

Step 2: Register Your Manager
Endpoint: POST /api/trinity/managers/register

Headers:

Content-Type: application/json
X-API-Key: <your-trinity-api-key>
Body:

{
  "name": "HDM",
  "displayName": "HyperDAG Manager",
  "systemUrl": "https://hyperdag.example.com",
  "specialty": "Technical Implementation & DAG Orchestration"
}
Response:

{
  "success": true,
  "manager": {
    "id": 2,
    "name": "HDM",
    "displayName": "HyperDAG Manager",
    "systemUrl": "https://hyperdag.example.com",
    "specialty": "Technical Implementation & DAG Orchestration",
    "online": true
  },
  "heartbeatIntervalSec": 300,
  "currentPromptVersion": 6,
  "message": "Manager HDM registered successfully"
}
Step 3: Send Regular Heartbeats
Endpoint: POST /api/trinity/managers/heartbeat

Headers:

Content-Type: application/json
X-API-Key: <your-trinity-api-key>
Body:

{
  "managerName": "HDM",
  "status": "healthy",
  "promptVersion": 6,
  "metrics": {
    "uptimeSec": 3600,
    "queueDepth": 0,
    "errors24h": 0
  },
  "message": "HDM processing tasks normally"
}
Heartbeat Interval: Every 5 minutes (300 seconds) Grace Period: 2 minutes Timeout: Manager shows as offline if no heartbeat for >7 minutes (5 min interval + 2 min grace period)

Step 4: Sync Active Prompt
Endpoint: GET /api/trinity/prompt/current

Response:

{
  "success": true,
  "prompt": {
    "id": 6,
    "version": 6,
    "promptText": "Demonstrate autonomous real-time coordination...",
    "title": "Real-Time Trinity Execution Test",
    "description": "Testing sub-second execution",
    "isActive": true
  }
}
Call this endpoint:

On startup to get the current prompt
When receiving a prompt update notification
Periodically (e.g., with heartbeat)
ðŸ“Š Checking Trinity Status
Endpoint: GET /api/trinity/managers

Response:

{
  "success": true,
  "managers": [
    {
      "id": 1,
      "name": "APM",
      "displayName": "AI Prompt Manager",
      "online": true,
      "lastHeartbeat": "2025-10-21T04:41:10.140Z",
      "specialty": "Strategic Planning & Prompt Distribution"
    }
  ],
  "count": 1,
  "onlineCount": 1
}
ðŸ”¥ Real-Time Execution Flow
User deploys prompt at /trinity-prompt
APM broadcasts new prompt to all managers in real-time (<100ms)
Each manager:
Receives prompt instantly
Acknowledges receipt
Reports execution time
User sees: "3 Trinity managers acknowledged in 82ms" ðŸš€
ðŸ§ª Testing the Integration
Example cURL Command (HDM)
# Register
curl -X POST https://apm-url.repl.co/api/trinity/managers/register \
  -H "Content-Type: application/json" \
  -H "X-API-Key: $HYPERDAG_API_KEY" \
  -d '{
    "name": "HDM",
    "displayName": "HyperDAG Manager",
    "systemUrl": "https://hyperdag.example.com",
    "specialty": "Technical Implementation & DAG Orchestration"
  }'
# Send heartbeat
curl -X POST https://apm-url.repl.co/api/trinity/managers/heartbeat \
  -H "Content-Type: application/json" \
  -H "X-API-Key: $HYPERDAG_API_KEY" \
  -d '{
    "managerName": "HDM",
    "status": "healthy",
    "metrics": { "uptimeSec": 3600, "queueDepth": 0, "errors24h": 0 }
  }'
Example cURL Command (Mel)
# Register
curl -X POST https://apm-url.repl.co/api/trinity/managers/register \
  -H "Content-Type: application/json" \
  -H "X-API-Key: $IMAGEBEARERAI_API_KEY_PRIMARY" \
  -d '{
    "name": "Mel",
    "displayName": "ImageBearerAI",
    "systemUrl": "https://imagebearerai.com",
    "specialty": "Ethical Wisdom & Biblical Guidance"
  }'
# Send heartbeat
curl -X POST https://apm-url.repl.co/api/trinity/managers/heartbeat \
  -H "Content-Type: application/json" \
  -H "X-API-Key: $IMAGEBEARERAI_API_KEY_PRIMARY" \
  -d '{
    "managerName": "Mel",
    "status": "healthy",
    "metrics": { "uptimeSec": 7200, "queueDepth": 0, "errors24h": 0 }
  }'
ðŸŽ¯ Expected Result
Once HDM and Mel register and send heartbeats, you'll see:

Trinity Prompt Distribution Dashboard:

Trinity Managers
3 of 3 Trinity managers online
[â—] APM - AI Prompt Manager (Online)
[â—] HDM - HyperDAG Manager (Online)  
[â—] Mel - ImageBearerAI (Online)
Real-Time Execution:

ðŸš€ Real-Time Execution Complete!
3 Trinity managers acknowledged in 82ms
ðŸ” Security Notes
API keys are required for all manager operations
Keys are stored as environment secrets
CORS enabled only for trusted domains
Rate limiting: 30 requests/minute per manager
ðŸ“± Next Steps
HDM Team: Use the cURL example above to register your system
Mel Team: Use the cURL example above to register your system
Test: Deploy a prompt at /trinity-prompt and watch all 3 execute in <100ms
Monitor: Check /trinity-coordination dashboard for real-time status