# üîÑ HYPERDAGMANAGER: GitHub Export & Sync Setup

## CONTEXT
You are HyperDagManager running on Replit. We need to export your code to GitHub to establish it as the source of truth and enable infrastructure coordination.

## YOUR MISSION
1. Export your current codebase to GitHub
2. Document your infrastructure components
3. Set up sync capability

---

## STEP 1: INVENTORY YOUR INFRASTRUCTURE (2 minutes)

Run this command to map what you manage:

```bash
# Show your directory structure
tree -L 3 -I 'node_modules|__pycache__|.git' || find . -type d -not -path '*/\.*' -not -path '*/node_modules/*' | head -30

# List configuration files
find . -name "*.yaml" -o -name "*.yml" -o -name "*.json" -o -name "*.toml" -o -name "*.conf" | grep -v node_modules

# Show infrastructure scripts
ls -lah *.sh *.py *.js 2>/dev/null

# Check for Docker/deployment files
ls -lah Dockerfile docker-compose.yml fly.toml vercel.json netlify.toml 2>/dev/null || echo "No deployment configs found"
```

**Report back:**
- Infrastructure managed: [e.g., networking, CORS, WebSocket, deployment]
- Config files count: ___
- Deployment files: ___
- Main scripts: ___

---

## STEP 2: CREATE INFRASTRUCTURE MANIFEST (3 minutes)

Document what you manage:

```bash
cat > HDM-MANIFEST.md << 'EOF'
# HyperDagManager Infrastructure Manifest

## Responsibilities
- [ ] Network configuration and CORS policies
- [ ] WebSocket connection management
- [ ] API gateway routing
- [ ] Database connections and pooling
- [ ] Deployment pipelines
- [ ] Health checks and monitoring
- [ ] Load balancing
- [ ] Rate limiting
- [ ] SSL/TLS certificates
- [ ] Environment variable management
- [ ] Docker container orchestration
- [ ] CI/CD workflows

## Current Configuration

### Network Settings
- CORS origins: [list]
- Allowed methods: [list]
- Rate limits: [describe]

### WebSocket Config
- Endpoint: [url]
- Max connections: [number]
- Timeout: [seconds]

### Database Connections
- Primary: [connection string format]
- Replicas: [count]
- Pool size: [number]

### Deployment Targets
- Production: [platform/url]
- Staging: [platform/url]
- Development: [platform/url]

## Files Managed by HDM
[List your key configuration files here]

## Dependencies
- External services: [list]
- Required secrets: [list names only, not values]
- API integrations: [list]

## Health Check Endpoints
- Status: [url]
- Metrics: [url]
- Logs: [url]

## Last Updated
[Date/timestamp]
EOF

# Edit the manifest with your actual details
nano HDM-MANIFEST.md  # or use your preferred editor
```

---

## STEP 3: PREPARE FOR EXPORT (3 minutes)

### Create .gitignore for infrastructure:

```bash
cat > .gitignore << 'EOF'
# Replit
.replit
.config/
.cache/
.upm/
replit.nix

# Secrets - CRITICAL: Never commit these
.env
.env.*
*.key
*.pem
*.crt
*.p12
secrets.json
credentials.json
service-account.json
*secret*
*password*
*token*

# Infrastructure state
terraform.tfstate
terraform.tfstate.backup
.terraform/
*.tfvars

# Build artifacts
dist/
build/
*.log
*.pid
*.seed
*.pid.lock

# OS
.DS_Store
Thumbs.db

# IDE
.vscode/
.idea/
EOF
```

### Create sanitized config examples:

```bash
# If you have .env files, create .env.example with dummy values
cat > .env.example << 'EOF'
# Database
DATABASE_URL=postgresql://user:password@localhost:5432/dbname
REDIS_URL=redis://localhost:6379

# API Keys (replace with your actual keys)
GITHUB_TOKEN=ghp_xxxxxxxxxxxxx
OPENAI_API_KEY=sk-xxxxxxxxxxxxx

# Network
CORS_ORIGINS=http://localhost:3000,https://yourdomain.com
PORT=8080
NODE_ENV=production

# WebSocket
WS_PORT=8081
WS_MAX_CONNECTIONS=1000
EOF
```

---

## STEP 4: EXPORT TO GITHUB (5 minutes)

### Option A: Replit Version Control (RECOMMENDED)

1. Open **Version Control** tab in left sidebar
2. Initialize repo if not already done
3. Stage all files (review that no secrets are included!)
4. Commit message: "HDM: Initial export - infrastructure & networking configs"
5. Connect to GitHub
6. Push to `dealappseo/trinity-symphony-shared`

### Option B: Manual Git Commands

```bash
# Initialize
git init

# Configure
git config user.name "HyperDagManager"
git config user.email "hdm@trinitysymphony.ai"

# Stage everything (after creating .gitignore)
git add .

# Review what will be committed (CRITICAL - check for secrets!)
git status

# If any secrets appear, add them to .gitignore and re-stage
# git reset
# echo "secret-file.json" >> .gitignore
# git add .

# Commit
git commit -m "HDM: Infrastructure export - configs, networking, deployment"

# Remote will be added by user
# git remote add origin [URL]
```

**üö® CRITICAL SECURITY CHECK:**

Before pushing, verify no secrets:

```bash
# Check for common secret patterns
git diff --cached | grep -iE '(password|secret|key|token|api_key)' | grep -v example | grep -v "PLACEHOLDER"

# If anything shows up that looks like a real secret, DON'T PUSH
# Add it to .gitignore and recommit
```

---

## STEP 5: VERIFY EXPORT (2 minutes)

After pushing:

```bash
# Verify commit
git log -1 --stat

# Check what's tracked
git ls-files

# Verify remote
git remote -v

# Test pull (make sure sync works both ways)
git pull origin main
```

**Report back:**
- ‚úÖ Commit hash: ___________
- ‚úÖ Infrastructure files exported: ___ count
- ‚úÖ Config examples created: Yes/No
- ‚úÖ Secrets excluded: Yes/No
- ‚úÖ GitHub URL: https://github.com/dealappseo/trinity-symphony-shared/tree/main/infrastructure/hdm

---

## STEP 6: CREATE AUTO-SYNC SCRIPT (10 minutes)

For infrastructure changes that need immediate sync:

```python
# infra_sync.py
import subprocess
import sys
from datetime import datetime

def check_secrets():
    """Verify no secrets in staged changes"""
    result = subprocess.run(
        ['git', 'diff', '--cached'],
        capture_output=True,
        text=True
    )
    
    dangerous_patterns = [
        'password=',
        'api_key=',
        'secret=',
        'token=',
        'ghp_',
        'sk-',
        '-----BEGIN'
    ]
    
    for pattern in dangerous_patterns:
        if pattern.lower() in result.stdout.lower():
            print(f"üö® DANGER: Potential secret detected: {pattern}")
            print("Aborting sync. Add to .gitignore!")
            return False
    return True

def sync_infrastructure():
    """Sync infrastructure changes to GitHub"""
    try:
        # Check for changes
        status = subprocess.run(
            ['git', 'status', '--porcelain'],
            capture_output=True,
            text=True
        )
        
        if not status.stdout.strip():
            print("No infrastructure changes to sync")
            return True
        
        # Stage changes
        subprocess.run(['git', 'add', '.'], check=True)
        
        # Security check
        if not check_secrets():
            subprocess.run(['git', 'reset'], check=True)
            return False
        
        # Commit
        timestamp = datetime.now().strftime('%Y-%m-%d %H:%M:%S')
        commit_msg = f"HDM: Infrastructure update at {timestamp}"
        subprocess.run(['git', 'commit', '-m', commit_msg], check=True)
        
        # Push
        subprocess.run(['git', 'push'], check=True)
        
        print(f"‚úÖ Infrastructure synced to GitHub at {timestamp}")
        return True
        
    except subprocess.CalledProcessError as e:
        print(f"‚ùå Sync failed: {e}")
        return False

if __name__ == "__main__":
    success = sync_infrastructure()
    sys.exit(0 if success else 1)
```

**Usage:** `python infra_sync.py` after config changes

---

## FALLBACK OPTION: ZIP DOWNLOAD

If git fails:

1. **BEFORE downloading:** Manually remove any files with secrets
2. Click repl menu ‚Üí Download as zip
3. Report: "ZIP ready, secrets removed"

---

## SUCCESS CRITERIA

‚úÖ Infrastructure code backed up to GitHub  
‚úÖ Configuration examples provided (no real secrets)  
‚úÖ HDM-MANIFEST.md documents your responsibilities  
‚úÖ Can sync changes bidirectionally  
‚úÖ Security check passed (no secrets committed)

---

## REPORT FORMAT

```
üéØ HDM GITHUB EXPORT COMPLETE

Status: ‚úÖ SUCCESS / ‚ö†Ô∏è PARTIAL / ‚ùå FAILED

Export Method: [Replit Version Control / Manual Git / ZIP]
Commit Hash: [abc123...]
Files Exported: [count]
Secrets Excluded: ‚úÖ CONFIRMED
GitHub URL: https://github.com/dealappseo/trinity-symphony-shared/tree/main/infrastructure/hdm

Infrastructure Components Exported:
- [networking configs]
- [deployment files]
- [monitoring setup]

Config Examples Created:
- .env.example
- [other examples]

Security Status:
‚úÖ No secrets in commit
‚úÖ .gitignore properly configured
‚úÖ Sensitive files excluded

Blockers (if any):
- [list]

Next Steps:
- [what's needed]
```

---

**BEGIN NOW:** Start with STEP 1 (Inventory) and report your infrastructure map.

You're the backbone of Trinity Symphony - let's get you backed up! üöÄ